import{x as O,v as R,r as i,j as s,F as h,q as $,c as f,B as D}from"./index-85ab92a3.js";const P=()=>{const{id:d}=O(),y=R(),[u,j]=i.useState(""),[C,S]=i.useState([]),[x,w]=i.useState(""),[b,k]=i.useState({}),[v,A]=i.useState({}),[g,T]=i.useState({});i.useEffect(()=>{function a(o){let e=o+"=",c=decodeURIComponent(document.cookie).split(";");for(let l=0;l<c.length;l++){let t=c[l];for(;t.charAt(0)==" ";)t=t.substring(1);if(t.indexOf(e)==0)return t.substring(e.length,t.length)}return""}w(a("access"));async function n(){const e=await(await fetch(`http://localhost:8000/api/getFormbyid/${d}`,{method:"GET",headers:{"Content-Type":"application/json"}})).json();j(e.title),console.log(u),S(e.categories)}n()},[d]);const B=(a,n)=>{k(o=>({...o,[a]:n}))},z=(a,n,o)=>{A(e=>{const r=e[a]||[];return o?{...e,[a]:[...r,n]}:{...e,[a]:r.filter(c=>c!==n)}})},E=(a,n)=>{T(o=>({...o,[a]:n}))},F=async a=>{a.preventDefault();const n={shortAnswers:b,checkboxAnswers:v,radioAnswers:g};var o={form:d};await(await fetch("http://localhost:8000/api/save_form",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${x}`},body:JSON.stringify(o)})).json();const c=await(await fetch("http://localhost:8000/api/save_response",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${x}`},body:JSON.stringify(n)})).json();console.log(c),y("/accuser_reception")};return s.jsx("div",{style:{},children:s.jsxs(h,{onSubmit:F,children:[s.jsx("h1",{children:u}),s.jsxs($,{xl:18,children:[C.map(({questions:a,title:n},o)=>s.jsx(f,{style:{width:"70%",marginBottom:"20px"},children:s.jsx(f.Body,{children:s.jsxs("div",{children:[s.jsxs("h2",{children:["Section ",o+1,": ",n]}),s.jsx("ul",{style:{listStyle:"none",paddingLeft:0},children:a.map(({id:e,question_type:r,label:c,choices:l})=>s.jsxs("li",{children:[s.jsx("h4",{style:{fontSize:"1.5em"},children:c}),r==="short_answer"&&s.jsx(h.Control,{style:{fontSize:"1.3em",width:"200px",border:"0.1px black solid",marginBottom:"10px"},type:"text",onChange:t=>B(e,t.target.value)}),r==="checkboxes"&&l.map(({option:t},m)=>s.jsx(h.Check,{style:{fontSize:"1.3em"},type:"checkbox",label:t,value:t,onChange:p=>z(e,t,p.target.checked)},m)),r==="multiple_choice"&&l.map(({option:t},m)=>s.jsx(h.Check,{style:{fontSize:"1.3em"},type:"radio",name:`radio-${e}`,label:t,value:t,checked:g[e]===t,onChange:p=>E(e,p.target.value)},m))]},e))})]},o)})})),s.jsx(D,{type:"submit",style:{width:"10%",marginLeft:"2%",marginTop:"2.5%"},variant:"primary",children:"Envoyer"})]})]})})};export{P as default};
